<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Collection of phylogenetic tree statistics, collected throughout the literature. All functions have been written to maximize computation speed. The package includes umbrella functions to calculate all statistics, all balance associated statistics, or all branching time related statistics. Furthermore, the treestats package supports summary statistic calculations on Ltables, provides speed-improved coding of branching times, Ltable conversion and includes algorithms to create intermediately balanced trees. Full description can be found in Janzen (2023) &lt;doi:10.1101/2024.01.24.576848&gt;.">
<title>Phylogenetic Tree Statistics • treestats</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Phylogenetic Tree Statistics">
<meta property="og:description" content="Collection of phylogenetic tree statistics, collected throughout the literature. All functions have been written to maximize computation speed. The package includes umbrella functions to calculate all statistics, all balance associated statistics, or all branching time related statistics. Furthermore, the treestats package supports summary statistic calculations on Ltables, provides speed-improved coding of branching times, Ltable conversion and includes algorithms to create intermediately balanced trees. Full description can be found in Janzen (2023) &lt;doi:10.1101/2024.01.24.576848&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">treestats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Example_abc.html">Example: abc</a>
    <a class="dropdown-item" href="articles/Example_data.html">Example: data</a>
    <a class="dropdown-item" href="articles/Getting_started.html">Getting started</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thijsjanzen/treestats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="treestats">treestats<a class="anchor" aria-label="anchor" href="#treestats"></a>
</h1></div>
<p><a href="https://cran.r-project.org/package=treestats" class="external-link"><img src="https://www.r-pkg.org/badges/version/treestats" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=treestats" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/treestats"></a> <a href="https://cran.r-project.org/package=treestats" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/treestats"></a> <a href="https://github.com/thijsjanzen/treestats/actions" class="external-link"><img src="https://github.com/thijsjanzen/treestats/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Branch</th>
<th>CodeCov</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>main</td>
<td><a href="https://app.codecov.io/gh/thijsjanzen/treestats" class="external-link"><img src="https://codecov.io/gh/thijsjanzen/treestats/branch/main/graph/badge.svg" alt="codecov.io"></a></td>
</tr>
<tr class="even">
<td>develop</td>
<td><a href="https://app.codecov.io/gh/thijsjanzen/treestats" class="external-link"><img src="https://codecov.io/gh/thijsjanzen/treestats/branch/develop/graph/badge.svg" alt="codecov.io"></a></td>
</tr>
</tbody>
</table>
<p>The treestats R package contains rapid, C++ based, functions to calculate summary statistics on phylogenies, assuming the phylogenies.</p>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To get started, you can either install from CRAN or use the latest version from GitHub:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"treestats"</span><span class="op">)</span> <span class="co"># install from CRAN</span></span>
<span></span>
<span><span class="co"># use the devtools package to install latest version from GitHub:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"thijsjanzen/treestats"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p>Given a tree (for example a simulated tree, as in the code example), you can either access individual statistics, or calculate all currently implemented statistics:</p>
<pre><code><span><span class="va">focal_tree</span>   <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rphylo</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, birth <span class="op">=</span> <span class="fl">1</span>, death <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">colless_stat</span> <span class="op">&lt;-</span> <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="reference/colless.html">colless</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span></span>
<span><span class="va">all_stats</span>    <span class="op">&lt;-</span> <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="list-of-statistics">List of statistics<a class="anchor" aria-label="anchor" href="#list-of-statistics"></a>
</h3>
<p>The following summary statistics are included: | Statistic | Information | Fischer | Normalization | Assumes Ultrametric tree | Requires binary tree | Reference | | ———————- | ————————- | ——— | ————- | ———————— | ——————– | ——————————– | | area_per_pair | Topology | Shape | Yule | NO | YES | Lima et al., 2020 | | average_leaf_depth | Topology | Imbalance | Yule | NO | YES | Shao &amp; Sokal, 1990 | | avg_ladder | Topology | Shape | None | NO | YES | Kendall et al., 2018 | | avg_vert_depth | Topology | Imbalance | None | NO | NO | Colijn &amp; Gardy, 2014 | | b1 | Topology | Balance | Tips | NO | NO | Shao &amp; Sokal, 1990 | | b2 | Topology | Balance | Yule | NO | NO | Shao &amp; Sokal, 1990 | | beta | Topology | No index | None | NO | YES | Aldous, 1996 | | blum | Topology | Imbalance | None | NO | YES | Blum &amp; François, 2006 | | cherries | Topology | Shape | Yule | NO | YES | McKenzie et al., 1999 | | colless | Topology | Imbalance | Yule | NO | YES | Colless, 1982 | | colless_corr | Topology | Imbalance | None | NO | YES | Heard, 1992 | | colless_quad | Topology | Imbalance | None | NO | YES | Bartoszek et al., 2021 | | crown_age | Branching times | No index | None | NO | NO | | | diameter | Topology | Shape | None | NO | YES | Chindelevitch et al., 2021 | | double_cherries | Topology | Shape | None | NO | YES | Chindelevitch et al., 2021 | | eigen_centrality | Topology | No index | None | NO | NO | Chindelevitch et al., 2021 | | eigen_centralityW | Topology + branch lengths | No index | None | NO | NO | Chindelevitch et al., 2021 | | ew_colless | Topology | Imbalance | None | NO | YES | Mooers &amp; S. B. Heard, 1997 | | four_prong | Topology | Shape | None | NO | YES | Chindelevitch et al., 2021 | | gamma | Branching times | No index | None | YES | NO | Pybus &amp; Harvey, 2000 | | i_stat | Topology | Imbalance | None | NO | YES | Fusco &amp; Cronk, 1995 | | il_number | Topology | Shape | Tips | NO | NO | Kendall et al., 2018 | | imbalance_steps | Topology | No index | Tips | NO | NO | Janzen &amp; Etienne, 2024 | | j_one | Topology | No index | None | NO | YES | Lemant et al., 2022 | | j_stat | Topology + branch lengths | No index | None | NO | NO | Izsák &amp; Papp, 2000 | | laplace_spectrum_a | Topology + branch lengths | No index | None | YES | NO | Lewitus &amp; Morlon, 2016 | | laplace_spectrum_e | Topology + branch lengths | No index | None | YES | NO | Lewitus &amp; Morlon, 2016 | | laplace_spectrum_g | Topology + branch lengths | No index | None | YES | NO | Lewitus &amp; Morlon, 2016 | | laplace_spectrum_p | Topology + branch lengths | No index | None | YES | NO | Lewitus &amp; Morlon, 2016 | | max_adj | Topology + branch lengths | No index | None | NO | YES | Chindelevitch et al., 2021 | | max_betweenness | Topology | Shape | Tips | NO | YES | Chindelevitch et al., 2021 | | max_closeness | Topology | Shape | Tips | NO | YES | Chindelevitch et al., 2021 | | max_closenessW | Topology + branch lengths | Shape | None | NO | YES | Chindelevitch et al., 2021 | | max_del_width | Topology | Shape | Tips | NO | NO | Colijn &amp; Gardy, 2014 | | max_depth | Topology | Imbalance | Tips | NO | NO | Colijn &amp; Gardy, 2014 | | max_ladder | Topology | Shape | None | NO | YES | Kendall et al., 2018 | | max_laplace | Topology + branch lengths | No index | None | NO | YES | Chindelevitch et al., 2021 | | max_width | Topology | Balance | Tips | NO | NO | Colijn &amp; Gardy, 2014 | | mean_branch_length | Topology + branch lengths | No index | None | NO | NO | Janzen &amp; Etienne, 2017 | | mean_branch_length_ext | Topology + branch lengths | No index | None | NO | NO | Saulnier et al., 2017 | | mean_branch_length_int | Topology + branch lengths | No index | None | NO | NO | Saulnier et al., 2017 | | min_adj | Topology + branch lengths | No index | None | NO | YES | Chindelevitch et al., 2021 | | min_laplace | Topology + branch lengths | No index | None | NO | YES | Chindelevitch et al., 2021 | | mntd | Topology + branch lengths | No index | None | NO | NO | Webb et al., 2002 | | mpd | Topology + branch lengths | No index | Tips | NO | NO | Webb et al., 2002 | | mw_over_md | Topology | Balance | None | NO | NO | Colijn &amp; Gardy, 2014 | | nltt_base | Branching times | No index | None | YES | NO | Janzen et al., 2015 | | number_of_lineages | Topology + branch lengths | No index | None | NO | NO | | | phylogenetic_div | Topology + branch lengths | No index | None | NO | NO | Faith, 1992 | | pigot_rho | Branching times | No index | None | YES | NO | Pigot et al., 2010 | | pitchforks | Topology | Shape | Tips | NO | NO | Kendall et al., 2018 | | psv | Topology + branch lengths | No index | Tips | NO | NO | Helmus et al., 2007 | | rogers | Topology | Imbalance | Tips | NO | YES | Rogers, 1996 | | root_imbalance | Topology | Shape | None | NO | YES | Guyer et al., 1993 | | rquartet | Topology | Balance | Yule | NO | NO | Coronado et al., 2019 | | sackin | Topology | Imbalance | Yule | NO | YES | Sackin, 1972 | | stairs | Topology | Imbalance | None | NO | YES | Norström et al., 2012 | | stairs2 | Topology | Balance | None | NO | YES | Norström et al., 2012 | | symmetry_nodes | Topology | Imbalance | Tips | NO | YES | Kersting &amp; Fischer, 2021 | | tot_coph | Topology | Imbalance | Yule | NO | YES | Mir et al., 2013 | | tot_internal_path | Topology | Imbalance | None | NO | NO | Knuth, 1997 | | tot_path | Topology | Imbalance | None | NO | YES | Colijn &amp; Gardy, 2014 | | tree_height | Branching times | No index | None | NO | NO | | | treeness | Topology + branch lengths | No index | None | NO | NO | Astolfi &amp; Zonta-Sgaramella, 1984 | | var_branch_length | Topology + branch lengths | No index | None | NO | NO | Saulnier et al., 2017 | | var_branch_length_ext | Topology + branch lengths | No index | None | NO | NO | Saulnier et al., 2017 | | var_branch_length_int | Topology + branch lengths | No index | None | NO | NO | Saulnier et al., 2017 | | var_depth | Topology | Imbalance | Yule | NO | NO | Coronado et al., 2020 | | vpd | Topology + branch lengths | No index | None | NO | NO | Webb et al., 2002 | | wiener | Topology + branch lengths | Shape | None | NO | YES | Chindelevitch et al., 2021 |</p>
</div>
</div>
<div class="section level2">
<h2 id="rcpp">Rcpp<a class="anchor" aria-label="anchor" href="#rcpp"></a>
</h2>
<p>For all of these statistics, the package provides Rcpp versions that are much, much faster than their R sister functions. Furthermore, some additional functions have been improved as well: - ape::branching.times - DDD::phylo2L - DDD::L2phylo</p>
<div class="float">
<img src="https://github.com/thijsjanzen/treestats/assets/19486664/606a33c0-67d2-4b96-876b-81853adf59cd" alt="Figure_S3"><div class="figcaption">Figure_S3</div>
</div>
</div>
<div class="section level2">
<h2 id="c-library">C++ Library<a class="anchor" aria-label="anchor" href="#c-library"></a>
</h2>
<p>For the Rcpp improved summary statistics (excluding statistics that rely on the calculation of eigen values, as these rely on the Rcpp independent Eigen code), R independent C++ code is provided in the inst/include folder. These can be independently linked by adding the treestats package in the DESCRIPTION in both the LinkingTo and Depends fields. Then, in your package, you can also calculate these functions.</p>
<p>Please note that for all functions, there are two versions available: 1) based on input of a phylo object, which is typically one 2-column matrix containing all edges, and a vector containing the edge lengths (depending on which information is required to calculate the statistic). 2) based on input of an Ltable (Lineage table), which is a 4-column matrix containing information on each species, being 1) birth time, 2) parent species, 3) species label and 4) death time (or -1 if extant).</p>
<p>Ltable input can be useful when summary statistics are required for more complicated simulation models.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=treestats" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/thijsjanzen/treestats/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/thijsjanzen/treestats/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing treestats</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Thijs Janzen <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-4162-1140" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thijs Janzen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

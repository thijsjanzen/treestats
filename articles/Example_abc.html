<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="treestats">
<title>Example: abc • treestats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example: abc">
<meta property="og:description" content="treestats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">treestats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example_abc.html">Example: abc</a>
    <a class="dropdown-item" href="../articles/Example_data.html">Example: data</a>
    <a class="dropdown-item" href="../articles/Getting_started.html">Getting started</a>
    <a class="dropdown-item" href="../articles/Speed_improvement.html">Speed improvement</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thijsjanzen/treestats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example: abc</h1>
                        <h4 data-toc-skip class="author">Thijs
Janzen</h4>
            
            <h4 data-toc-skip class="date">2024-07-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thijsjanzen/treestats/blob/HEAD/vignettes/Example_abc.Rmd" class="external-link"><code>vignettes/Example_abc.Rmd</code></a></small>
      <div class="d-none name"><code>Example_abc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abc">ABC<a class="anchor" aria-label="anchor" href="#abc"></a>
</h2>
<p>In Approximate Bayesian Computation (ABC), the goal is to fit a model
to data by comparing summary statistics of data simulated under the
model, with summary statistics of the target data. By minimizing the
difference in summary statistics between simulated and target data, ABC
then fits the model. Here, we will make use of abcrf, a fast method to
use ABC that makes use of decision trees to build a random forest. These
trees will be trained (abcrf in a way is a kind of machine learning
approach to ABC) on training data, and can then be used to predict
outcomes on test data.</p>
<div class="section level3">
<h3 id="simple-parameter-example">Simple parameter example<a class="anchor" aria-label="anchor" href="#simple-parameter-example"></a>
</h3>
<p>In this example, we will see if abcrf can be trained to estimate the
birth rate on a Yule tree (e.g. without extinction). First, we generate
training data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_points</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">num_points</span>,</span>
<span>                    ncol <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/list_statistics.html">list_statistics</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_points</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rphylo</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, birth <span class="op">=</span> <span class="va">b</span>, death <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">focal_stats</span> <span class="op">&lt;-</span> <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span></span>
<span>  <span class="va">test_data</span><span class="op">[</span><span class="va">r</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">focal_stats</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required namespace: RSpectra</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"birth"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">focal_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<p>Given the training data, we can create our random forest:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu">regAbcrf</span><span class="op">(</span><span class="va">birth</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">test_data</span>, ntree <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>With our random forest set up, let’s put it to the test on some other
Yule tree:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rphylo</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, birth <span class="op">=</span> <span class="fl">0.5</span>, death <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">test_stats</span> <span class="op">&lt;-</span> <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">test_tree</span><span class="op">)</span></span>
<span><span class="va">test_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">test_stats</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">test_stats</span>, <span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      expectation    median variance (post.MSE.mean) variance.cdf quantile=0.025</span></span>
<span><span class="co">## [1,]   0.4096861 0.4055519              0.003548676  0.002715648      0.3182503</span></span>
<span><span class="co">##      quantile=0.975 post.NMAE.mean</span></span>
<span><span class="co">## [1,]      0.5497408      0.1219827</span></span></code></pre>
<p>We see that even using only 100 decision trees, the parameter
estimate is quite close to 0.5. This can be visualized further:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">densityPlot</span><span class="op">(</span><span class="va">forest</span>, <span class="va">test_stats</span>, <span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in density.default(resp, weights = weights.std[, i], ...): Selecting</span></span>
<span><span class="co">## bandwidth *not* using 'weights'</span></span>
<span><span class="co">## Warning in density.default(resp, weights = weights.std[, i], ...): Selecting</span></span>
<span><span class="co">## bandwidth *not* using 'weights'</span></span></code></pre>
<p><img src="Example_abc_files/figure-html/plot_simpl2-1.png" width="576"></p>
<p>Interestingly, we can also assess which summary statistics were most
informative:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forest</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_abc_files/figure-html/plot_simple-1.png" width="576">
This indicates that for estimating the parameters, the mean branch
length and phylogenetic diversity - both branch length dependent
parameters, e.g.  properties of the tree directly related to the
speciation rate - are most decisive in determining the birth rate.</p>
</div>
<div class="section level3">
<h3 id="comparing-models">Comparing models<a class="anchor" aria-label="anchor" href="#comparing-models"></a>
</h3>
<p>ABCrf can also be used to do model selection. Here, we will extend
the Yule data we generated before with trees generated using the DDD
model, and see if abcrf can distinguish between these two models. First,
we prep our new training data frame and generate DDD trees:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">test_data</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_points</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">DDD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DDD/man/dd_sim.html" class="external-link">dd_sim</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b</span>, <span class="fl">0</span>, <span class="fl">130</span><span class="op">)</span>, age <span class="op">=</span> <span class="fl">26.5</span><span class="op">)</span><span class="op">$</span><span class="va">tes</span></span>
<span>  <span class="co"># too small trees will yield NA values</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">DDD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DDD/man/dd_sim.html" class="external-link">dd_sim</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b</span>, <span class="fl">0</span>, <span class="fl">130</span><span class="op">)</span>, age <span class="op">=</span> <span class="fl">26.5</span><span class="op">)</span><span class="op">$</span><span class="va">tes</span></span>
<span>  <span class="va">focal_stats</span> <span class="op">&lt;-</span> <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span></span>
<span>  <span class="va">new_test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">new_test_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">focal_stats</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">for_abc</span> <span class="op">&lt;-</span> <span class="va">new_test_data</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">new_test_data</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">for_abc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">focal_stats</span><span class="op">)</span>, <span class="st">"model"</span><span class="op">)</span></span>
<span><span class="va">for_abc</span><span class="op">$</span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">for_abc</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu">abcrf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/abcrf/man/abcrf.html" class="external-link">abcrf</a></span><span class="op">(</span><span class="va">model</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">for_abc</span>, ntree <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in lda.default(x, grouping, ...): variables are collinear</span></span></code></pre>
<p>The random forest can now be plotted, and be used to assess target
trees:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">for_abc</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_abc_files/figure-html/plot_abcrf_model_select-1.png" width="576"></p>
<pre><code><span><span class="co">## Press &lt;ENTER&gt; to Continue</span></span></code></pre>
<p><img src="Example_abc_files/figure-html/plot_abcrf_model_select-2.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rlineage.html" class="external-link">rphylo</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, birth <span class="op">=</span> <span class="fl">0.5</span>, death <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">to_test</span>, <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">DDD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DDD/man/dd_sim.html" class="external-link">dd_sim</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">130</span><span class="op">)</span>, age <span class="op">=</span> <span class="fl">26.5</span><span class="op">)</span><span class="op">$</span><span class="va">tes</span></span>
<span>  <span class="co"># too small trees will yield NA values</span></span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">focal_tree</span> <span class="op">&lt;-</span> <span class="fu">DDD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DDD/man/dd_sim.html" class="external-link">dd_sim</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">130</span><span class="op">)</span>, age <span class="op">=</span> <span class="fl">26.5</span><span class="op">)</span><span class="op">$</span><span class="va">tes</span></span>
<span>  <span class="va">to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">to_test</span>, <span class="fu">treestats</span><span class="fu">::</span><span class="fu"><a href="../reference/calc_all_stats.html">calc_all_stats</a></span><span class="op">(</span><span class="va">focal_tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">to_test</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">to_test</span>, <span class="va">for_abc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    selected model votes model1 votes model2 post.proba</span></span>
<span><span class="co">## 1               1         1000            0     1.0000</span></span>
<span><span class="co">## 2               1          970           30     1.0000</span></span>
<span><span class="co">## 3               1          990           10     1.0000</span></span>
<span><span class="co">## 4               1         1000            0     1.0000</span></span>
<span><span class="co">## 5               1         1000            0     0.9987</span></span>
<span><span class="co">## 6               2            0         1000     1.0000</span></span>
<span><span class="co">## 7               2            0         1000     1.0000</span></span>
<span><span class="co">## 8               2            0         1000     1.0000</span></span>
<span><span class="co">## 9               2            0         1000     0.9978</span></span>
<span><span class="co">## 10              2            0         1000     1.0000</span></span></code></pre>
<p>Indeed, we see that the first five trees are convincingly assigned
model 1 (BD), and that the last five trees are convincingly assigned
model 2 (DDD).</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thijs Janzen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
